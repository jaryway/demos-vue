import{c as f}from"./index-chunk-QjCAiRJA.js";import{D as C}from"./vuedraggable.umd-chunk-xwdDg5WC.js";import{c as w}from"./set-chunk-QyXzr2mm.js";import{d as E,i as _,w as R,c as n,m as h,r as T,o as re,a as ue,b as L,p as ie,n as de}from"./index-4ZEX7zKC.js";import{C as ce,R as pe,A as me,D as ye,T as A,I as fe,S as Ee,a as be,E as Ie}from"./index-chunk-0SEdEAcD.js";import{E as D,c as U,d as F}from"./el-button-chunk-nNtG46M-.js";import{E as ge}from"./el-select-chunk-egAgXB4X.js";import"./_commonjsHelpers-chunk-4gQjN7DL.js";import"./isUndefined-chunk-OffvT6Ak.js";const he={typeId:"PROVINCE_CITY",typeName:"地址",config:{label:"地址",labelWidth:null,showLabel:!0,changeTag:!1,tag:"province-city",tagIcon:"input",defaultValue:void 0,showDefaultValue:!0,displayType:!0,required:!1,layout:"colFormItem",span:24},detailsValue:void 0,type:1,placeholder:void 0,readonly:!1,editable:!0,visibility:!0,conditionType:7,__slot__:{options:[{label:"省-市-区",value:1},{label:"省-市-区-详细地址",value:2}]}},Te={typeId:"BUTTON",typeName:"按钮",config:{label:"按钮",showLabel:!1,changeTag:!0,labelWidth:null,tag:"el-button",tagIcon:"button",defaultValue:void 0,showDefaultValue:!1,showRegList:!1,required:void 0,showRequired:!1,regList:[],displayType:!1,span:24,layout:"colFormItem",url:void 0},__slot__:{default:"按钮"},btnAction:[],type:"primary",round:!1,size:"small",plain:!1,circle:!1,disabled:!1,editable:!0},De={typeId:"CHECKBOX",typeName:"复选框组",config:{label:"复选框组",tag:"el-checkbox-group",tagIcon:"checkbox",defaultValue:[],showDefaultValue:!1,span:24,showLabel:!0,displayType:!0,labelWidth:null,layout:"colFormItem",optionType:"default",required:!1,changeTag:!0,border:!1},__slot__:{options:[{label:"选项一",value:1},{label:"选项二",value:2}]},size:"small",segment:"vertical",readonly:!1,editable:!0,visibility:!0,conditionType:4},Re={typeId:"SELECT-MULTIPLE",typeName:"下拉复选框",config:{label:"下拉复选框",showLabel:!0,defaultValue:void 0,showDefaultValue:!1,labelWidth:null,tag:"el-select",tagIcon:"select",layout:"colFormItem",displayType:!0,span:24,required:!1,multiple:!0,changeTag:!0},__slot__:{options:[{label:"选项一",value:1},{label:"选项二",value:2}]},placeholder:"请选择",clearable:!0,filterable:!0,multiple:!0,readonly:!1,editable:!0,visibility:!0,optionsModel:0,linkValue:{},conditionType:6},Ce={typeId:"DATE",typeName:"日期时间",config:{label:"日期时间",tag:"el-date-picker",tagIcon:"date",showDefaultValue:!0,defaultValue:null,defaultValueType:0,defaultValueSource:{type:0,id:""},displayType:!0,showLabel:!0,labelWidth:null,span:24,layout:"colFormItem",required:!1,changeTag:!0},placeholder:"请选择",type:"date",clearable:!0,format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",readonly:!1,editable:!0,visibility:!0,conditionType:2},_e={typeId:"DIVIDER",typeName:"分割线",config:{label:"分割线",defaultValue:"",displayType:!0,showLabel:!0,showDefaultValue:!1,showRequired:!1,showClearable:!1,tag:"el-divider",tagIcon:"divider",layout:"colFormItem",required:void 0,changeTag:!1},color:void 0,notChild:!0},Le={typeId:"LINKED_DATA",typeName:"关联数据",config:{label:"关联数据",labelWidth:null,showLabel:!0,changeTag:!0,tag:"my-form",tagIcon:"input",defaultValue:void 0,showDefaultValue:!1,displayType:!0,required:!1,layout:"colFormItem",span:24},showTitle:!0,linkList:[],linkedShowField:[],linkedFillRules:[],filterCond:[],readonly:!1,editable:!0,visibility:!0},ve={typeId:"QUERY_CHECK",typeName:"关联查询",config:{layout:"colFormItem",label:"关联查询",labelWidth:null,showLabel:!0,changeTag:!0,tag:"my-form",tagIcon:"input",showDefaultValue:!1,displayType:!0,span:24,dbTable:""},linkList:[],filterCond:[],linkedShowField:[],dataNum:1,canAdd:!0,visibility:!0},Ae={typeId:"INPUT_MAP",typeName:"定位",config:{label:"定位",labelWidth:null,showLabel:!0,changeTag:!1,tag:"input-map",tagIcon:"input",showDefaultValue:!0,defaultValue:void 0,defaultValueType:0,defaultValueSource:{type:0,id:""},displayType:!0,required:!1,limitTargeting:!1,limitTargetingOpt:1,layout:"colFormItem",span:24,auto:""},placeholder:void 0,showLatitudeAndLongitude:!1,allowFineTuning:!1,readonly:!1,editable:!0,visibility:!0,fineTuningNum:0,conditionType:8},Oe={typeId:"NUMBER_INPUT",typeName:"数字",controls:!1,config:{label:"数字",showLabel:!0,changeTag:!0,labelWidth:null,tag:"el-input-number",tagIcon:"number",defaultValue:void 0,defaultValueType:0,defaultValueSource:{type:0,id:""},displayType:!0,span:24,layout:"colFormItem",required:!1,format:1,typeOption:[{label:"数值",value:1},{label:"百分比",value:2}],showDecimal:!1,showThousandsSeparator:!1,limitRange:!1},placeholder:"请输入",min:void 0,max:void 0,step:1,"step-strictly":!1,precision:void 0,"controls-position":"",readonly:!1,editable:!0,visibility:!0,conditionType:1},m={typeId:"MEMBER_RADIO",typeName:"成员单选",config:{label:"成员单选",labelWidth:null,showLabel:!0,changeTag:!0,tag:"dept-and-user",tagIcon:"input",showDefaultValue:!0,defaultValue:[],defaultValueType:0,defaultValueSource:{type:0,id:""},displayType:!0,required:!1,layout:"colFormItem",span:24,optionalRange:0,dept:1},__slot__:{default:"选择成员"},readonly:!1,editable:!0,visibility:!0,conditionType:10,listRange:[],optionalRange:0},Ne={typeId:"RADIO",typeName:"单选按钮组",config:{label:"单选按钮组",labelWidth:null,showLabel:!0,displayType:!0,tag:"el-radio-group",tagIcon:"radio",changeTag:!0,showDefaultValue:!1,defaultValue:void 0,layout:"colFormItem",span:24,optionType:"default",required:!1,border:!1},__slot__:{options:[{label:"选项一",value:1},{label:"选项二",value:2}]},size:"small",segment:"vertical",readonly:!1,editable:!0,visibility:!0,conditionType:3},Me={typeId:"SELECT",typeName:"下拉框",config:{label:"下拉框",showLabel:!0,defaultValue:void 0,showDefaultValue:!1,labelWidth:null,tag:"el-select",tagIcon:"select",layout:"colFormItem",displayType:!0,span:24,required:!1,changeTag:!0},__slot__:{options:[{label:"选项一",value:1,checked:!1},{label:"选项二",value:2,checked:!1}]},placeholder:"请选择",clearable:!0,filterable:!0,multiple:!1,readonly:!1,editable:!0,visibility:!0,optionsModel:0,linkValue:{},conditionType:5,limitRepeat:0,repeatReminderText:"此项内容已存在，不允许重复提交"},we={typeId:"SERIALNUMBER_INPUT",typeName:"流水号",config:{label:"流水号",labelWidth:null,showLabel:!0,changeTag:!0,tag:"el-input",tagIcon:"input",showDefaultValue:!1,defaultValue:"",displayType:!0,layout:"colFormItem",span:24},placeholder:"自动生成无需填写",__slot__:{},serialNumberRule:[{name:"自动计数",ruleType:"0",countDigits:5,fixedDigits:1,resetPeriod:"0",initialValue:1,dateFormatType:0,dateFormatStr:"yyyy-MM-dd",fixedCharacter:"num",vModel:"name",label:"5位数字,不自动重置"}],disabled:!0,visibility:!0,notChild:!0,onlyOne:!0},Ue={typeId:"SIGN_PAD",typeName:"手写签名",config:{label:"手写签名",defaultValue:"",showLabel:!0,showDefaultValue:!1,displayType:!0,showRequired:!0,showClearable:!1,showRegList:!1,tag:"sign-pad",tagIcon:"sign-pad",layout:"colFormItem",span:24,required:!1,changeTag:!1},color:"#000000",readonly:!1,editable:!0,visibility:!0},Fe={typeId:"CHILD_FORM",typeName:"子表单",config:{label:"子表单",labelWidth:null,showLabel:!0,changeTag:!0,tag:"my-table",tagIcon:"input",showDefaultValue:!0,defaultValue:void 0,defaultValueType:0,defaultValueSource:{type:0,id:""},displayType:!0,required:void 0,showRequired:!1,layout:"rowFormItem"},children:[],tableList:[],__slot__:{dataList:[]},children:[],fieldDisplayRules:[],readonly:!1,editable:!0,visibility:!0,notChild:!0},Pe={typeId:"INPUT",typeName:"单行文本",config:{label:"单行文本",labelWidth:null,showLabel:!0,changeTag:!0,tag:"el-input",tagIcon:"input",defaultValue:"",defaultValueType:0,defaultValueSource:{type:0,id:""},displayType:!0,required:!1,layout:"colFormItem",span:24,format:"text",typeOption:[{label:"无",value:"text"},{label:"手机号码",value:"phoneNumber"},{label:"电话号码",value:"tel"},{label:"邮政编码",value:"zipCode"},{label:"身份证号码",value:"idNumber"},{label:"邮箱",value:"email"}]},placeholder:"请输入",readonly:!1,editable:!0,visibility:!0,limitRepeat:0,repeatReminderText:"此项内容已存在，不允许重复提交"},Se={typeId:"TEXTAREA",typeName:"多行文本",config:{label:"多行文本",labelWidth:null,showLabel:!0,tag:"el-input",tagIcon:"textarea",defaultValue:"",defaultValueType:0,defaultValueSource:{type:0,id:""},displayType:!0,required:!1,layout:"colFormItem",span:24,changeTag:!0},type:"textarea",placeholder:"请输入",autosize:{minRows:3,maxRows:5},maxlength:null,"show-word-limit":!1,readonly:!1,editable:!0,readonly:!1,visibility:!0},Ve={typeId:"UPLOAD-FILE",typeName:"附件",config:{label:"附件",tag:"el-upload",tagIcon:"upload",layout:"colFormItem",showDefaultValue:!1,defaultValue:null,displayType:!0,showLabel:!0,showRegList:!1,labelWidth:null,required:!1,span:24,showTip:!1,buttonText:"点击上传",changeTag:!0},expand:{limit:0,fileSize:10,sizeUnit:"MB",accept:""},setting:{onlyOne:!1,accept:"",limit:!1},__slot__:{"list-type":!0},"show-file-list":!1,name:"file","auto-upload":!0,"list-type":"text",multiple:!0,editable:!0,visibility:!0,readonly:!1},Be={typeId:"UPLOAD-IMG",typeName:"图片",config:{label:"图片",tag:"el-upload",tagIcon:"upload",layout:"colFormItem",showDefaultValue:!1,defaultValue:null,displayType:!0,showLabel:!0,showRegList:!1,labelWidth:null,required:!1,span:24,showTip:!1,changeTag:!0},expand:{limit:0,fileSize:10,sizeUnit:"MB"},setting:{onlyOne:!1,limit:!1},__slot__:{"list-type":!0},accept:"image/*","show-file-list":!1,name:"file","auto-upload":!0,"list-type":"picture",multiple:!0,drag:!0,readonly:!1,editable:!0,visibility:!0},P="BUTTON",S="SERIALNUMBER_INPUT",V="INPUT",B="TEXTAREA",x="NUMBER_INPUT",k="PROVINCE_CITY",K="INPUT_MAP",H="UPLOAD-IMG",q="UPLOAD-FILE",$="CHILD_FORM",G="QUERY_CHECK",z="LINKED_DATA",X="SIGN_PAD",W="MEMBER_RADIO",Y="MEMBER_CHECK",Q="DEPT_RADIO",j="DEPT_CHECK",Z="ROLE_RADIO",J="ROLE_CHECK",ee="DATE",te="RADIO",ae="CHECKBOX",le="SELECT",oe="SELECT-MULTIPLE",ne="DIVIDER",xe="button",ke="serialnumber",Ke="text",He="textarea",qe="number",$e="address",Ge="location",ze="uploadimg",Xe="uploadfile",We="subform",Ye="linkquery",Qe="linkfield",je="signature",Ze="memberradio",Je="membercheck",et="deptradio",tt="deptcheck",at="roleradio",lt="rolecheck",ot="datetime",nt="radiogroup",st="checkboxgroup",rt="select",ut="comboselect",it="divider",o={BUTTON:xe,SERIALNUMBER:ke,TEXT:Ke,TEXTAREA:He,NUMBER:qe,ADDRESS:$e,LOCATION:Ge,UPLOADIMG:ze,UPLOADFILE:Xe,SUBFORM:We,LINKQUERY:Ye,LINKFIELD:Qe,SIGNATURE:je,MEMBERRADIO:Ze,MEMBERCHECK:Je,DEPTRADIO:et,DEPTCHECK:tt,ROLERADIO:at,ROLECHECK:lt,DATETIME:ot,RADIOGROUP:nt,CHECKBOXGROUP:st,SELECT:rt,COMBOSELECT:ut,DIVIDER:it},se={BUTTON:P,SERIALNUMBER:S,TEXT:V,TEXTAREA:B,NUMBER:x,ADDRESS:k,LOCATION:K,UPLOADIMG:H,UPLOADFILE:q,SUBFORM:$,LINKQUERY:G,LINKFIELD:z,SIGNATURE:X,MEMBERRADIO:W,MEMBERCHECK:Y,DEPTRADIO:Q,DEPTCHECK:j,ROLERADIO:Z,ROLECHECK:J,DATETIME:ee,RADIOGROUP:te,CHECKBOXGROUP:ae,SELECT:le,COMBOSELECT:oe,DIVIDER:ne},d={[o.BUTTON]:{...Te,typeId:P},[o.SERIALNUMBER]:{...we,typeId:S},[o.TEXT]:{...Pe,typeId:V},[o.TEXTAREA]:{...Se,typeId:B},[o.NUMBER]:{...Oe,typeId:x},[o.ADDRESS]:{...he,typeId:k},[o.LOCATION]:{...Ae,typeId:K},[o.UPLOADIMG]:{...Be,typeId:H},[o.UPLOADFILE]:{...Ve,typeId:q},[o.SUBFORM]:{...Fe,typeId:$},[o.LINKQUERY]:{...ve,typeId:G},[o.LINKFIELD]:{...Le,typeId:z},[o.SIGNATURE]:{...Ue,typeId:X},[o.DATETIME]:{...Ce,typeId:ee},[o.RADIOGROUP]:{...Ne,typeId:te},[o.CHECKBOXGROUP]:{...De,typeId:ae},[o.SELECT]:{...Me,typeId:le},[o.COMBOSELECT]:{...Re,typeId:oe},[o.DIVIDER]:{..._e,typeId:ne},[o.MEMBERRADIO]:{...m,typeId:W,typeName:"成员单选",config:{...m.config,label:"成员单选"}},[o.MEMBERCHECK]:{...m,typeId:Y,typeName:"成员多选",config:{...m.config,label:"成员多选"}},[o.DEPTRADIO]:{...m,typeId:Q,typeName:"部门单选",config:{...m.config,label:"部门单选"}},[o.DEPTCHECK]:{...m,typeId:j,typeName:"部门多选",config:{...m.config,label:"部门多选"}},[o.ROLERADIO]:{...m,typeId:Z,typeName:"角色单选",config:{...m.config,label:"角色单选"}},[o.ROLECHECK]:{...m,typeId:J,typeName:"角色多选",config:{...m.config,label:"角色多选"}}},dt=[d[o.ADDRESS],d[o.LOCATION],d[o.UPLOADIMG],d[o.UPLOADFILE],d[o.SUBFORM],d[o.LINKQUERY],d[o.LINKFIELD],d[o.SIGNATURE],d[o.SERIALNUMBER],d[o.MEMBERRADIO],d[o.MEMBERCHECK],d[o.DEPTRADIO],d[o.DEPTCHECK],d[o.ROLERADIO],d[o.ROLECHECK]],ct=[d[o.TEXT],d[o.TEXTAREA],d[o.NUMBER],d[o.DATETIME],d[o.RADIOGROUP],d[o.CHECKBOXGROUP],d[o.SELECT],d[o.COMBOSELECT],d[o.DIVIDER],d[o.BUTTON]];function pt(){let e=new Date-new Date("2022-07-01");e+=Math.ceil(Math.random()*1e3);const u="ABCDEFGHIGKLMNOPQRSTUVWXYZabcdefghigklmnopqrstuvwxyz",t=u.split(""),l=u.length,a=[];do{const r=e%l;e=(e-r)/l,a.push(t[r])}while(e);return a.join("")}const mt=(e=0)=>["field",pt(),new Date().getTime(),e+1].join(""),yt=E({setup(e,{emit:u}){let t=1;const l=(s,...c)=>{const i=mt(t++);return{...w(s),vModel:i}},a=[{key:"basic",label:"基础",items:ct},{key:"advanced",label:"高级",items:dt}],r=_("FormDesignContext");return R(()=>r.active,s=>{},{immediate:!0,deep:!0}),()=>n("div",null,[n("div",{class:"aside-content"},[a.map(s=>n("div",{class:"widget-group",key:s.key},[n("h4",{class:"widget-group-title"},[s.label]),n(C,h({tag:"div",list:s.items,itemKey:"name",class:"widget-list","ghost-class":"list-group-1",clone:l},{sort:!1,group:{name:"component",pull:"clone",put:!1},onMove:()=>!1,onStart:c=>{},onEnd:c=>{r.select(c.item._underlying_vm_)},onClone(c){c.item,c.clone}}),{item:({element:c})=>n("div",{class:f("widget-item",{})},[c.typeName])})]))])])}}),ft="_subform_11t1l_1",y={subform:ft,"col-label":"_col-label_11t1l_6","col-control":"_col-control_11t1l_15","row-num":"_row-num_11t1l_24","row-head":"_row-head_11t1l_28","subform-container":"_subform-container_11t1l_31","subform-item-list":"_subform-item-list_11t1l_37","subform-item":"_subform-item_11t1l_37"},Et=E({props:{field:{type:Object,required:!0}},setup(e){const u=T(),t=_("FormDesignContext"),l=e.field.parentKey;return re(()=>{u.value}),ue(()=>{}),R(()=>e.field.children||[],()=>{},{immediate:!0,deep:!0}),()=>n("div",{class:y.subform,ref:u},[n("div",{class:f(y["row-head"]),onClick:a=>{}},[n("div",{class:y["col-label"]},null),n("div",{class:f(y["col-control"],y["row-num"])},[L("1")])]),n("div",{class:y["subform-container"]},[n(C,h({list:e.field.children||[],class:y["subform-item-list"],"ghost-class":"subform-item-ghost",componentData:{"data-tip":"从左侧拖拽来添加字段"},itemKey:"vModel"},{direction:"horizontal",group:{name:"subform",pull:!1,put:(a,r,s)=>s._underlying_vm_.typeId!==se.SUBFORM},onChange:function(a){a.added&&(a.added.element.parentKey=l)}}),{item:({element:a,index:r})=>{var s,c;return n("div",{class:f(y["subform-item"],{active:((s=t.active)==null?void 0:s.value)===a}),onClick:i=>{i.preventDefault(),i.stopPropagation(),t.select(a)}},[n("div",{class:y["col-label"]},[a.config.label]),n("div",{class:y["col-control"]},[n(ge,null,null)]),n("div",{class:"dnd-item-mask"},[n("div",{class:f("field-button-group",{active:((c=t.active)==null?void 0:c.value)===a})},[n(D,{onClick:i=>{i.preventDefault(),i.stopPropagation(),t.duplicate(e.field.children||[],r,a)}},{default:()=>[n(U,null,null)]}),n(D,h({class:"btn-delete"},{onClick:i=>{i.preventDefault(),i.stopPropagation(),t.remove(e.field.children||[],r)}}),{default:()=>[n(F,null,null)]})])])])}})])])}}),bt=E({props:{dataComponentType:String},setup(e){const{dataComponentType:u,...t}=e;return()=>n("div",{class:"unknown-field",style:{padding:"var(--van-padding-md)",color:"var(--van-text-color-2)"}},[u,L("找不到对应的组件或者该组件不支持在移动端显示")])}}),O={checkboxgroup:ce,radiogroup:pe,address:me,datetime:ye,text:A,textarea:A,number:fe,select:Ee,comboselect:be,subform:Et,unknown:bt},It=e=>{switch(e){case"INPUT":case"SERIALNUMBER_INPUT":return"text";case"TEXTAREA":return"textarea";case"NUMBER_INPUT":return"number";case"PROVINCE_CITY":return"address";case"INPUT_MAP":return"location";case"UPLOAD-IMG":case"UPLOAD-FILE":return"upload";case"CHILD_FORM":return"subform";case"QUERY_CHECK":return"linkquery";case"LINKED_DATA":return"linkfield";case"SIGN_PAD":return"signature";case"MEMBER_RADIO":case"MEMBER_CHECK":case"DEPT_RADIO":case"DEPT_CHECK":case"ROLE_RADIO":case"ROLE_CHECK":return"orgpickerinput";case"DATE":return"datetime";case"RADIO":return"radiogroup";case"CHECKBOX":return"checkboxgroup";case"SELECT":return"select";case"SELECT-MULTIPLE":return"comboselect";case"DIVIDER":return"divider";default:return"unknown"}},g={phoneNumber:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,tel:/^0\d{2,3}-\d{7,8}|\(?0\d{2,3}[)-]?\d{7,8}|\(?0\d{2,3}[)-]*\d{7,8}$/,zipCode:/^\d{6}$/,idNumber:/^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$|^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}([0-9]|X)$/,email:/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/};function gt(e){switch(e){case"phoneNumber":return{pattern:g.phoneNumber,message:"手机号码格式错误"};case"tel":return{pattern:g.tel,message:"电话号码格式错误"};case"zipCode":return{pattern:g.zipCode,message:"邮政号码格式错误"};case"idNumber":return{pattern:g.idNumber,message:"身份证号码格式错误"};case"email":return{pattern:g.email,message:"邮箱格式错误"};case 1:return{validator:u=>!isNaN(u),message:"格式错误",formatter:u=>u==null?"":Number(u.toString().replace(/,/g,""))}}}function ht(e){const{config:u,max:t,min:l}=e,a=e.label||(u==null?void 0:u.label),r=s=>s==null?0:Number(s.toString().replace(/,/g,""));if(t!==void 0&&l!==void 0)return{validator:s=>s<=t&&s>=l,message:"".concat(a," 在 ").concat(l," 到 ").concat(t," 之间"),formatter:r};if(t!==void 0)return{validator:s=>s<=t,message:"".concat(a," 不能大于 ").concat(t),formatter:r};if(l!==void 0)return{validator:s=>s>=l,message:"".concat(a," 不能小于 ").concat(l),formatter:r}}function Tt(e){const{config:u,typeId:t}=e,{required:l,format:a}=u||{},r=[];l&&r.push({required:!0,message:"必填项"});const s=ht(e),c=gt(a);return s&&r.push(s),c&&r.push(c),t==="CHILD_FORM"&&l&&r.push({validator:i=>Array.isArray(i)&&i.length>0,message:"必填项"}),r}function N(e){if(!["QUERY_CHECK","LINKED_DATA"].includes(e.typeId))return;const u=e.linkedShowField||[];return(e.linkList||[]).map(t=>{const l=e.typeId==="QUERY_CHECK"?!1:!u.some(a=>a.vModel===a.vModel);return{id:t.id,typeId:t.typeId,vModel:t.vModel,label:t.label,selectShowOnly:l,parentId:e.parentKey||"1"}})}const Dt=(e,u="editable")=>{var a,r,s,c,i,p,I,v;const{config:t}=e,l={label:(t==null?void 0:t.showLabel)===!1?"":e.label||(t==null?void 0:t.label),placeholder:e.placeholder,disabled:u==="readonly"?!0:e.editable===!1,readonly:u==="readonly"?!0:e.readonly===!0,required:t==null?void 0:t.required,rules:Tt(e),"data-component-type":e.typeId,"data-component-name":e.typeName,"data-vmodel":e.vModel};switch(e.typeId){case"INPUT":return{...l,maxlength:e.maxLength};case"TEXTAREA":return{...l,rows:((a=e.autosize)==null?void 0:a.minRows)||1,autosize:{maxHeight:((r=e.autosize)==null?void 0:r.maxRows)&&((s=e.autosize)==null?void 0:s.maxRows)*24,minHeight:((c=e.autosize)==null?void 0:c.minRows)&&((i=e.autosize)==null?void 0:i.minRows)*24},maxlength:e.maxLength};case"NUMBER_INPUT":return{...l,showThousandsSeparator:e.showThousandsSeparator,precision:e.showDecimal?0:e.precision};case"DATE":return{...l,type:e.type,maxDate:e.maxDate,minDate:e.minDate};case"RADIO":return{...l,options:(e.__slot__.options||[]).map(b=>({value:b.label,label:b.label,isOther:b.isOther})),direction:e.segment};case"CHECKBOX":return{...l,options:(e.__slot__.options||[]).map(b=>({value:b.label,label:b.label})),direction:e.segment};case"SELECT":case"SELECT-MULTIPLE":return e.optionsModel,{...l,options:e.__slot__.options};case"INPUT_MAP":return{...l,showLatitudeAndLongitude:e.showLatitudeAndLongitude};case"PROVINCE_CITY":return{...l,type:e.type};case"UPLOAD-IMG":case"UPLOAD-FILE":return{...l,color:e.color,fileSize:(p=e.expand)==null?void 0:p.fileSize,limit:((I=e.expand)==null?void 0:I.limit)||10,sizeUnit:(v=e.expand)==null?void 0:v.sizeUnit};case"SIGN_PAD":return{...l,color:e.color};case"MEMBER_RADIO":return{...l,type:["USER"],multiple:!1};case"MEMBER_CHECK":return{...l,type:["USER"],multiple:!0};case"DEPT_RADIO":return{...l,type:["DIVISION"],multiple:!1};case"DEPT_CHECK":return{...l,type:["DIVISION"],multiple:!0};case"ROLE_RADIO":return{...l,type:["ROLE"],multiple:!1};case"ROLE_CHECK":return{...l,type:["ROLE"],multiple:!0};case"CHILD_FORM":return{...l,children:e.children,allowAdd:e.allowAdd||!0};case"QUERY_CHECK":return{...l,multiple:(e.dataNum||1)>1,linkFields:N(e)};case"LINKED_DATA":return{...l,renderInTable:!!e.parentKey,formDesignerId:(t==null?void 0:t.dbTable)||"",filterCond:e.filterCond||[],linkFields:N(e)};case"SERIALNUMBER_INPUT":return{"data-component-type":e.typeId,"data-component-name":e.typeName,"data-vmodel":e.vModel,label:e.label||(t==null?void 0:t.label),description:e.description,readonly:!0,disabled:!0};case"DIVIDER":return{"data-component-type":e.typeId,"data-component-name":e.typeName,"data-vmodel":e.vModel,label:e.label||(t==null?void 0:t.label),description:e.description};default:return{"data-component-type":e.typeId}}},Rt=E({props:{items:{type:Array,required:!0},parent:{type:Object}},setup(e,{emit:u}){const t=T(!1),l=_("FormDesignContext");return R(()=>{var a;return(a=l.active)==null?void 0:a.value},a=>{},{immediate:!0,deep:!0}),()=>n(C,h({tag:e.parent?"div":"form",list:e.items,itemKey:"vModel","ghost-class":"dnd-item-ghost"},{swapThreshold:.3,group:{name:"component",pull:e.parent?!1:void 0},onMove:a=>!1,onStart:a=>{t.value=!0},onEnd:a=>{t.value=!1},onChange:function(a){a.added&&e.parent&&(a.added.element.parentKey=e.parent.id)}},{componentData:{"data-tip":"从左侧拖拽来添加字段"}}),{item:({element:a,index:r})=>{var i;let s=O[It(a.typeId)];s=s||O.unknown;const c=Dt(a,"editable");return n("div",{class:f("dnd-item",{active:((i=l.active)==null?void 0:i.value)===a}),onClick:p=>{p.preventDefault(),p.stopPropagation(),l.select(a)}},[n("div",{class:f("dnd-item-content",a.typeId.toLowerCase())},[n(Ie,{label:a.label||a.config.label,required:!0,style:{marginBottom:0,"flex-direction":a.typeId===se.SUBFORM?"column":"row"}},{default:()=>[n(s,c,null)]}),n("div",{class:"dnd-item-mask"},[n("div",{class:"field-button-group"},[n(D,{onClick:p=>{p.preventDefault(),p.stopPropagation(),l.duplicate(e.items,r,a)}},{default:()=>[n(U,null,null)]}),n(D,h({class:"btn-delete"},{onClick:p=>{p.preventDefault(),l.remove(e.items,r)}}),{default:()=>[n(F,null,null)]})])])])])}})}}),Ct=E({props:{items:{type:Array,required:!0}},setup(e,{emit:u}){return()=>n("div",{class:"form-design-content"},[n("div",{class:"form-design-content-col"},[n(Rt,{items:e.items,class:f("dnd-container el-form el-form--default",{"el-form--label-left":!0})},null)])])}}),_t=E({setup(e,{emit:u}){return()=>n("div",{class:"form-design-settings-panel"},[L("设置面板")])}});function Lt(){let e=new Date-new Date("2022-07-01");e+=Math.ceil(Math.random()*1e3);const u="ABCDEFGHIGKLMNOPQRSTUVWXYZabcdefghigklmnopqrstuvwxyz",t=u.split(""),l=u.length,a=[];do{const r=e%l;e=(e-r)/l,a.push(t[r])}while(e);return a.join("")}const M=(e=0)=>["field",Lt(),new Date().getTime(),e+1].join(""),vt=E({props:{config:{type:Object}},setup(e){var a;const u=T(((a=e.config)==null?void 0:a.fields)||[]),t=T();let l=0;return ie("FormDesignContext",{active:t,select:r=>{t.value=r},duplicate(r,s,c){const i=w(c),p=M(l++);i.vModel=p,i.children&&i.children.forEach(I=>{I.parentKey=p,I.vModel=M(l++)}),r.splice(s+1,0,i),de(()=>{t.value=i})},remove:(r,s)=>{t.value&&t.value===r[s]&&(t.value=void 0),r.splice(s,1)}}),R(()=>t.value,r=>{},{immediate:!0}),()=>n("div",{class:f("form-design")},[n(yt,{class:"form-design-aside"},null),n(Ct,{items:u.value,class:"form-design-content"},null),n(_t,{class:"form-design-settings-panel"},null)])}}),Vt=E({props:{},setup(){const e=T({description:"",fields:[]});return()=>n(vt,{config:e.value},null)}});export{Vt as default};
